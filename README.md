# HD 현대 AI CHALLENGE  [(Link)](https://dacon.io/competitions/official/236158/overview/description)

## 🏆 Result
- **Public score 9th(0.6%)** 32.05994 | **Private score 10th(0.6%)** 32.45594


본선진출조건 : 15등까지(성공)

본선진출시
<img width="100%" src="https://github.com/jjuhyeok/HD-AI_CHALLENGE/assets/49608953/79e812c3-1fab-44a1-be18-e5ac64883372"/>


주최 : HD한국조선해양 AI Center

주관 : DACON

규모 : 총 1320여명 참가


==========================================================
  
  

  

✏️
**대회 느낀점**
이번 대회를 진행하며 내가 제일 자신있던 부분에 대해 다시 한번 생각할 수 있었던 대회였습니다.
평소 데이터속에서 인사이트를 찾고 그 인사이트를 이용할 수 있는 방법들을 만드는 것을 좋아했었고
그만큼 EDA는 좋아하며 자신이있었습니다.
하지만 이번 대회는 그 자신감에서 오는 부주의함을 깨달을 수 있었습니다.
대회를 진행하며 모델링을 했을 때 "유가" 정보를 제외하고 modeling을 하면 점수가 많이 떨어졌습니다.
저는 이 현상을 보며 "아! 유가 정보는 간접적으로 시간에 대한 정보를 주기 때문에, 이번 모델링의 핵심은 먼저 시간에 대한 정보를 많이 표현을 해야겠다" 라며
대회에서 제공되지 않는 달러 외부데이터와 같은 데이터도 가져와서 사용하고 다양한 피처 엔지니어링 기법들을 통해
학습 데이터에 "시간"에 대한 표현을 많이 해주려 노력을 했었습니다.
그 결과 리더보드 상으로 보았을 때 모델링 정확도가 최상위권에 위치할 수 있었습니다.
아마 피처 엔지니어링을 통해 모델이 Feature Extraction을 잘 할수 있도록 했던 것 같습니다.
하지만 대회가 반 이상 지났을 때, 데이터의 이상이 있다는 점이 확인되었고
대회의 데이터가 변경되며 리더보드도 리셋이 되었습니다.
문제는 원유에 미래값인 Target값의 정보가 포함이 되어있었기 때문이었습니다.
이걸 알고 있었던 사람들은 로직과 같은 방법을 이용해 최고점을 찍고 있었습니다.
물론 데이터 오류였지만 스스로 데이터에는 미래의 값(Data Leakage)이 포함이 안되어있을거라고 가정을 하며 진행했던것이
원유 데이터에 에러가 있음을 파악하지 못했다는 것을 알았습니다.
이번 경험으로 당연히 아니겠지라고 넘기는 고정관념에서 벗어나 더 정확한 분석을 해야겠다고 깨달았습니다.

리더보드 초기화 후 새로운 데이터로 다시 모델링을 시작했는데
이 깨달음으로 다시 한번 천천히 EDA를 해보았습니다.
   

============================================================



<br>
===========================================================================


## Data Info
   
* train.csv  

100개 건물들의 2022년 06월 01일부터 2022년 08월 24일까지의 데이터  
일시별 기온, 강수량, 풍속, 습도, 일조, 일사 정보 포함  
전력사용량(kWh) 포함  


* building_info.csv  

100개 건물 정보  
건물 번호, 건물 유형, 연면적, 냉방 면적, 태양광 용량, ESS 저장 용량, PCS 용량  


* test.csv  
 
100개 건물들의 2022년 08월 25일부터 2022년 08월 31일까지의 데이터  
일시별 기온, 강수량, 풍속, 습도의 예보 정보  
 

---

## Process

**1. EDA** 
  * 빌딩별, 빌딩유형별, 지역별 전력 사용량 특성 확인
  * 시간별 전력 사용량 비교로 빌딩별 출근, 퇴근 시간 확인 및 쉬는 요일 파악
  * 빌딩간 day에 따른 power(ex, 대형마트는 2,4주째 일요일이 휴무일)
  * 시간 흐름에 따른 전력 사용량의 추세 파악
  
**2. Feature Engineering** 
  * 시간 feature들은 inherently cyclical 하다는 특징을 활용하기 위해 sin/cos 변환
  * 특정 피처들의 target 값의 평균으로 파생 변수 생성
  * 각 빌딩별로 출, 퇴근 시간을 계산하는 logic 을 구현하여 파생변수 생성 -> 관광지가 많은 곳은 교통량이 혼잡할 것이다 라는 가설
  * 폭염 주의보, 경보, 체감온도, 열대야, 냉방도일과 같은 온도 관련 파생변수 생성
  * 특정 시간대에 무조건 이전 시간대보다 전력 사용량이 증가 or 감소한다를 알려주는 파생변수 생성
  * 태양광 효율 파생변수 생성
  * 비가 올 때와 오지 않을 때의 전력 사용량 통계를 이용한 파생변수 생성
  * 이외의 feature engineering을 통해 총 60여개의 피처로 학습 진행

**3. Modeling**

  * XGBoostRegressor 모델 사용
  * Optuna를 활용하여 하이퍼파라미터 튜닝

**3. Validation**
  * 일반적인 K-fold
  * day에 따른 Stratify K-fold
  * day-hour에 따른 Stratify K-fold
  * week-day-hour에 따른 Stratify K-fold (public과 제일 Score 유사 == 강건한 모델링을 위한 Validation 방법)
  * 비가 올 때 안올 때 + week-day-hour에 따른 Stratify K-fold


**추가 시도 사항** (최종 결과 도출에는 비사용)
  * Test의 값들은 모두 "예보"이기 때문에 이를 보정하기 위한 방법이 필요하다고 생각하여 노이즈를 주거나 스무딩 기법 사용 -> 정확도가 오히려 낮아짐
  * 각 시간이나 빌딩의 특성을 더 강조하고 싶어 전력 사용량의 통계를 활용한 파생 변수들을 많이 만들었음 -> 정확도가 오히려 낮아짐
  * Stacking 기법
  * Temporal Fusion Transformer 사용 -> 성능이 엄청 높게 나왔지만, 사용 가능 gpu가 부족하여 그 뒤로는 시도하지 못했음

  
